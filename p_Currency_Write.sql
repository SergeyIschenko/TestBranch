IF (OBJECT_ID('p_Currency_Write', 'P') IS NULL)
	EXEC('CREATE PROCEDURE [dbo].p_Currency_Write AS')
GO
GRANT EXECUTE ON p_Currency_Write TO PUBLIC
GO

/****** Object:  Stored Procedure dbo.p_Currency_Write    Script Date: 20.10.2009 12:48:52 ******/
-- ============================================================================== --
--  
--  Валюта. Редактирование.
--  тест Test
-- ============================================================================== --
ALTER PROCEDURE [dbo].[p_Currency_Write]
@Mode            int         = 0,                 -- режим работы: 1 - INSERT, 2 - UPDATE, 3 - DELETE
@Currency_ID	 char(3)     = NULL,              -- код валюты
@Currency_Name	 varchar(50) = NULL,              -- название валюты
@Currency_ID_Old char(3)     = NULL               -- старыйк код валюты (только для UPDATE)
AS
-- ============================================================================== --
-- ============================================================================== --
IF (@Mode = 1)
BEGIN
  INSERT into sCurrency (Currency_ID, Currency_Name) values (@Currency_ID, @Currency_Name)
END
-- ============================================================================== --
IF (@Mode = 2)
BEGIN
  UPDATE sCurrency set Currency_ID = @Currency_ID, Currency_Name = @Currency_Name where Currency_ID = @Currency_ID_Old
END
-- ============================================================================== --
IF (@Mode = 3)
BEGIN
  DELETE from sCurrency where Currency_ID = @Currency_ID
END
-- ============================================================================== --
-- ============================================================================== --
-- ============================================================================== --
-- ============================================================================== --
-- ============================================================================== --
-- ============================================================================== --
-- ============================================================================== --
-- ============================================================================== --
-- ============================================================================== --
-- ============================================================================== --
-- ============================================================================== --


GO
